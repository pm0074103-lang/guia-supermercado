<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>S√∫per Gu√≠a Premium - ESPOL</title>
    <style>
        :root {
            --bg: #e0e5ec;
            --shadow: #a3b1c6;
            --light: #ffffff;
            --accent: #1a73e8;
            --danger: #d93025;
        }

        body { 
            font-family: 'Segoe UI', Roboto, sans-serif; 
            background: #2c3e50; 
            margin: 0; display: flex; justify-content: center; height: 100vh; overflow: hidden;
        }

        /* Contenedor con Neumorfismo (Efecto de relieve f√≠sico) */
        .app { 
            width: 100vw; max-width: 450px; background: var(--bg); 
            display: flex; flex-direction: column; position: relative;
            box-shadow: 20px 20px 60px #1a2530, -20px -20px 60px #3e5770;
        }

        /* PANTALLA DE INICIO ESTILO RETRO-MODERNO */
        #inicio { 
            position: absolute; inset: 0; background: var(--bg); z-index: 100; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center; 
        }

        .welcome-card {
            background: var(--bg); padding: 30px; border-radius: 30px;
            box-shadow: 9px 9px 16px var(--shadow), -9px -9px 16px var(--light);
            margin-bottom: 30px;
        }

        .btn-comenzar { 
            background: var(--bg); color: var(--accent); border: none; padding: 25px 50px; 
            border-radius: 50px; font-size: 24px; font-weight: 800; cursor: pointer;
            box-shadow: 6px 6px 12px var(--shadow), -6px -6px 12px var(--light);
            transition: all 0.2s ease;
        }
        .btn-comenzar:active { box-shadow: inset 6px 6px 12px var(--shadow), inset -6px -6px 12px var(--light); }

        /* HEADER Y BOT√ìN SOS */
        header { 
            padding: 20px; display: flex; justify-content: space-between; align-items: center;
            background: var(--bg); box-shadow: 0 5px 10px rgba(0,0,0,0.05);
        }

        .btn-sos {
            background: #ff4d4d; color: white; border: 4px solid #cc0000;
            padding: 12px 20px; border-radius: 15px; font-weight: 900; font-size: 18px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5); cursor: pointer;
            box-shadow: 0 5px 0 #990000;
        }
        .btn-sos:active { transform: translateY(3px); box-shadow: 0 2px 0 #990000; }

        /* GRILLA DE PRODUCTOS - BOTONES 3D */
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; padding: 20px; }
        
        .btn-prod {
            background: var(--bg); border: none; border-radius: 20px; padding: 15px 5px;
            box-shadow: 6px 6px 12px var(--shadow), -6px -6px 12px var(--light);
            display: flex; flex-direction: column; align-items: center; font-weight: bold;
            cursor: pointer; transition: 0.2s;
        }
        .btn-prod span { font-size: 30px; margin-bottom: 5px; }
        .btn-prod.active { box-shadow: inset 4px 4px 8px var(--shadow), inset -4px -4px 8px var(--light); color: var(--accent); }

        /* MAPA DETALLADO */
        #map-area { 
            flex: 1; margin: 20px; border-radius: 25px; background: #fff;
            box-shadow: inset 8px 8px 16px #d1d9e6, inset -8px -8px 16px #ffffff;
            position: relative; overflow: hidden; border: 3px solid var(--shadow);
        }
        canvas { width: 100%; height: 100%; display: block; }

        /* MODALES */
        .modal { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; z-index: 200; 
        }
        .modal-box { 
            background: var(--bg); padding: 40px; border-radius: 40px; text-align: center; width: 85%;
            box-shadow: 20px 20px 60px #000; border: 2px solid var(--light);
        }
        .btn-ok { 
            width: 100%; padding: 20px; background: var(--accent); color: white; border: none; 
            border-radius: 20px; font-size: 22px; font-weight: bold; margin-top: 20px;
        }
    </style>
</head>
<body>

    <div class="app">
        <div id="inicio">
            <div class="welcome-card">
                <div style="font-size: 80px;">üõí</div>
                <h1 style="color: #2c3e50; font-size: 32px;">¬°Hola!<br>Bienvenidos</h1>
                <p style="font-size: 20px; color: #5d707f;">Toque el bot√≥n azul para empezar a comprar.</p>
            </div>
            <button class="btn-comenzar" onclick="empezar()">COMENZAR</button>
        </div>

        <header>
            <div style="font-weight: 900; color: #2c3e50; font-size: 22px;">MI GU√çA</div>
            <button class="btn-sos" onclick="showHelp()">üÜò AYUDA</button>
        </header>

        <div class="grid">
            <button class="btn-prod" onclick="select('pan',this)"><span>üçû</span>Pan</button>
            <button class="btn-prod" onclick="select('leche',this)"><span>ü•õ</span>Leche</button>
            <button class="btn-prod" onclick="select('fruta',this)"><span>üçé</span>Frutas</button>
            <button class="btn-prod" onclick="select('carne',this)"><span>ü•©</span>Carnes</button>
            <button class="btn-prod" onclick="select('aseo',this)"><span>üßΩ</span>Aseo</button>
            <button class="btn-prod" onclick="select('salud',this)"><span>üíä</span>Salud</button>
        </div>

        <div id="map-area"><canvas id="cv"></canvas></div>

        <div style="padding:15px; text-align:center; font-weight:bold; color:#5d707f; background: rgba(255,255,255,0.5);">
            Toca el mapa blanco para "caminar"
        </div>
    </div>

    <div id="popWin" class="modal"><div class="modal-box">
        <h2 style="color:var(--accent); font-size: 35px;">üìç ¬°AQU√ç ES!</h2>
        <p style="font-size: 22px; font-weight: bold;">El producto que busca est√° frente a usted.</p>
        <button class="btn-ok" onclick="closeAll()">ENTENDIDO</button>
    </div></div>

    <div id="popSos" class="modal"><div class="modal-box">
        <h2 style="color:var(--danger); font-size: 35px;">üÜò AYUDA</h2>
        <p style="font-size: 22px; font-weight: bold;">¬°No se mueva!<br>Un asistente va en camino.</p>
        <button class="btn-ok" style="background:#5d707f" onclick="closeAll()">CERRAR</button>
    </div></div>

    <script>
        const canvas = document.getElementById('cv'); const ctx = canvas.getContext('2d');
        let pos = { x: 300, y: 550 }; let target = null;
        const pts = { pan:{x:120,y:120}, leche:{x:480,y:120}, fruta:{x:300,y:280}, carne:{x:120,y:420}, aseo:{x:480,y:420}, salud:{x:300,y:100} };

        function empezar() { document.getElementById('inicio').style.display = 'none'; initMap(); }
        function showHelp() { document.getElementById('popSos').style.display = 'flex'; }
        function closeAll() { document.querySelectorAll('.modal').forEach(m => m.style.display='none'); target=null; document.querySelectorAll('.btn-prod').forEach(b=>b.classList.remove('active')); draw(); }

        function initMap() { canvas.width = 600; canvas.height = 600; draw(); }

        function draw() {
            ctx.clearRect(0,0,600,600);
            // Piso detallado
            ctx.strokeStyle = "#eef2f7"; ctx.lineWidth = 2;
            for(let i=0; i<600; i+=40){ ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,600); ctx.stroke(); ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(600,i); ctx.stroke(); }
            
            // Estanter√≠as con volumen
            [[80,180,110,280],[245,180,110,280],[410,180,110,280]].forEach(s => {
                ctx.fillStyle = "#a3b1c6"; ctx.fillRect(s[0]+8, s[1]+8, s[2], s[3]); // Sombra proyectada
                ctx.fillStyle = "#ffffff"; ctx.fillRect(s[0], s[1], s[2], s[3]); // Cara superior
                ctx.strokeStyle = "#5d707f"; ctx.lineWidth = 3; ctx.strokeRect(s[0], s[1], s[2], s[3]);
                // Bordes de estantes internos
                ctx.beginPath(); ctx.moveTo(s[0], s[1]+140); ctx.lineTo(s[0]+s[2], s[1]+140); ctx.stroke();
            });

            if (target) {
                // Ruta Neum√≥rfica
                ctx.beginPath(); ctx.moveTo(pos.x, pos.y); ctx.lineTo(pos.x, target.y+50); ctx.lineTo(target.x, target.y+50); ctx.lineTo(target.x, target.y);
                ctx.shadowBlur = 10; ctx.shadowColor = "rgba(251, 191, 36, 0.5)";
                ctx.strokeStyle = "#fbbf24"; ctx.lineWidth = 18; ctx.lineJoin="round"; ctx.stroke(); ctx.shadowBlur = 0;
                ctx.font = "50px Arial"; ctx.fillText("üìç",target.x-25,target.y+15);
            }

            // Marcador "T√ö" estilo bot√≥n f√≠sico
            ctx.beginPath(); ctx.arc(pos.x, pos.y, 28, 0, Math.PI*2);
            ctx.fillStyle = "#1a73e8"; ctx.fill();
            ctx.strokeStyle = "white"; ctx.lineWidth = 6; ctx.stroke();
            ctx.fillStyle = "white"; ctx.font = "bold 18px Arial"; ctx.textAlign = "center"; ctx.fillText("T√ö",pos.x,pos.y+7);
        }

        function select(id, b) { target = pts[id]; document.querySelectorAll('.btn-prod').forEach(x => x.classList.remove('active')); b.classList.add('active'); draw(); }
        
        function move(cx, cy) {
            const r = canvas.getBoundingClientRect(); 
            pos.x = (cx - r.left) * (600 / r.width); 
            pos.y = (cy - r.top) * (600 / r.height);
            if (target && Math.sqrt((pos.x-target.x)**2 + (pos.y-target.y)**2) < 55) { document.getElementById('popWin').style.display="flex"; }
            draw();
        }

        canvas.addEventListener('mousedown', e => move(e.clientX, e.clientY));
        canvas.addEventListener('touchstart', e => { e.preventDefault(); move(e.touches[0].clientX, e.touches[0].clientY); }, {passive: false});
    </script>
</body>
</html>
