<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>S√∫per Gu√≠a Pro - ESPOL</title>
    <style>
        :root { --blue: #1a73e8; --red: #d93025; --green: #1e8e3e; --floor: #f8fafc; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: #0f172a; margin: 0; display: flex; justify-content: center; height: 100vh; overflow: hidden; }
        
        .app { width: 100vw; max-width: 450px; background: var(--floor); display: flex; flex-direction: column; position: relative; }

        /* Pantalla de Inicio */
        #inicio { position: absolute; inset: 0; background: white; z-index: 50; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 30px; text-align: center; }
        .logo-inicio { font-size: 80px; margin-bottom: 20px; }
        .btn-comenzar { background: var(--blue); color: white; border: none; padding: 20px 40px; border-radius: 50px; font-size: 22px; font-weight: bold; cursor: pointer; box-shadow: 0 10px 20px rgba(26,115,232,0.3); }

        /* Pantalla del Mapa */
        header { background: white; padding: 15px; text-align: center; border-bottom: 2px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding: 10px; background: white; }
        .btn { border: 2px solid #e2e8f0; background: #fff; padding: 10px; border-radius: 12px; font-weight: bold; cursor: pointer; display: flex; flex-direction: column; align-items: center; font-size: 13px; }
        .btn.active { border-color: var(--blue); background: #eff6ff; }
        
        #map-box { flex: 1; margin: 10px; border-radius: 15px; background: #fff; overflow: hidden; border: 2px solid #cbd5e1; position: relative; }
        canvas { width: 100%; height: 100%; display: block; touch-action: none; }

        /* Bot√≥n de Ayuda */
        .btn-ayuda { background: var(--red); color: white; border: none; padding: 10px 20px; border-radius: 10px; font-weight: bold; cursor: pointer; }

        /* Modales */
        .pop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; z-index: 100; }
        .pop-box { background: white; padding: 30px; border-radius: 25px; text-align: center; width: 80%; max-width: 320px; }
        .btn-modal { padding: 15px; width: 100%; background: var(--blue); color: white; border: none; border-radius: 12px; font-weight: bold; margin-top: 15px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="app">
        <div id="inicio">
            <div class="logo-inicio">üõí</div>
            <h1 style="color:var(--blue); margin:0;">¬°Bienvenidos!</h1>
            <p style="font-size: 18px; color: #64748b; margin: 20px 0 40px;">Comencemos con tus compras de hoy de forma f√°cil.</p>
            <button class="btn-comenzar" onclick="irAlMapa()">COMENZAR</button>
        </div>

        <header>
            <span style="font-weight: bold; color: var(--blue);">S√∫per Gu√≠a</span>
            <button class="btn-ayuda" onclick="pedirAyuda()">üÜò AYUDA</button>
        </header>

        <div class="grid">
            <button class="btn" onclick="sel('pan',this)"><span>üçû</span>Pan</button>
            <button class="btn" onclick="sel('leche',this)"><span>ü•õ</span>L√°cteos</button>
            <button class="btn" onclick="sel('fruta',this)"><span>üçé</span>Frutas</button>
            <button class="btn" onclick="sel('carne',this)"><span>ü•©</span>Carnes</button>
            <button class="btn" onclick="sel('aseo',this)"><span>üßΩ</span>Aseo</button>
            <button class="btn" onclick="sel('salud',this)"><span>üíä</span>Salud</button>
        </div>

        <div id="map-box"><canvas id="c"></canvas></div>

        <div style="padding:10px; text-align:center; font-size:14px; color:#64748b; background:white;">
            Toca el mapa para simular que caminas
        </div>
    </div>

    <div id="pop" class="pop"><div class="pop-box">
        <h2 style="color:var(--green)">¬°LLEG√ì! üéØ</h2>
        <p>El producto est√° justo frente a usted.</p>
        <button class="btn-modal" onclick="cerrarPop()">Aceptar</button>
    </div></div>

    <div id="popAyuda" class="pop"><div class="pop-box">
        <h2 style="color:var(--red)">Solicitando ayuda...</h2>
        <p style="font-size: 18px; font-weight: bold;">¬°No se preocupe! Un asistente ya va en camino para ayudarle.</p>
        <button class="btn-modal" onclick="document.getElementById('popAyuda').style.display='none'">Entendido</button>
    </div></div>

    <script>
        const cv = document.getElementById('c'); const ctx = cv.getContext('2d');
        let p = { x: 300, y: 550 }; let d = null;
        const pts = { pan:{x:120,y:120}, leche:{x:480,y:120}, fruta:{x:300,y:280}, carne:{x:120,y:420}, aseo:{x:480,y:420}, salud:{x:300,y:100} };

        function irAlMapa() { document.getElementById('inicio').style.fadeOut = "0.5s"; document.getElementById('inicio').style.display = 'none'; init(); }
        function pedirAyuda() { document.getElementById('popAyuda').style.display = 'flex'; }
        function init() { cv.width = 600; cv.height = 600; draw(); }
        
        function draw() {
            ctx.clearRect(0,0,600,600);
            ctx.strokeStyle = "#f1f5f9"; ctx.lineWidth = 1;
            for(let i=0; i<600; i+=30){ ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i,600); ctx.stroke(); ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(600,i); ctx.stroke(); }
            [[80,180,100,280],[250,180,100,280],[420,180,100,280]].forEach(s => {
                ctx.fillStyle = "#cbd5e1"; ctx.fillRect(s[0]+5, s[1]+5, s[2], s[3]);
                ctx.fillStyle = "#fff"; ctx.fillRect(s[0], s[1], s[2], s[3]);
                ctx.strokeStyle = "#94a3b8"; ctx.lineWidth = 2; ctx.strokeRect(s[0], s[1], s[2], s[3]);
            });
            if (d) {
                ctx.beginPath(); ctx.moveTo(p.x,p.y); ctx.lineTo(p.x,d.y+40); ctx.lineTo(d.x,d.y+40); ctx.lineTo(d.x,d.y);
                ctx.strokeStyle = "rgba(251, 191, 36, 0.4)"; ctx.lineWidth = 20; ctx.lineJoin="round"; ctx.stroke();
                ctx.strokeStyle = "#fbbf24"; ctx.lineWidth = 10; ctx.stroke();
                ctx.font = "40px Arial"; ctx.fillText("üìç",d.x-20,d.y+15);
            }
            ctx.beginPath(); ctx.arc(p.x,p.y,24,0,Math.PI*2); ctx.fillStyle = "#1a73e8"; ctx.fill();
            ctx.strokeStyle = "white"; ctx.lineWidth = 5; ctx.stroke();
            ctx.fillStyle = "white"; ctx.font = "bold 16px sans-serif"; ctx.textAlign = "center"; ctx.fillText("T√ö",p.x,p.y+6);
        }

        function sel(id,b) { d = pts[id]; document.querySelectorAll('.btn').forEach(x=>x.classList.remove('active')); b.classList.add('active'); draw(); }
        function move(cx,cy) {
            const r = cv.getBoundingClientRect(); p.x = (cx-r.left)*(600/r.width); p.y = (cy-r.top)*(600/r.height);
            if (d && Math.sqrt((p.x-d.x)**2+(p.y-d.y)**2)<50) document.getElementById('pop').style.display="flex";
            draw();
        }
        function cerrarPop() { document.getElementById('pop').style.display='none'; d=null; document.querySelectorAll('.btn').forEach(x=>x.classList.remove('active')); draw(); }

        cv.addEventListener('mousedown',e=>move(e.clientX,e.clientY));
        cv.addEventListener('touchstart',e=>{e.preventDefault(); move(e.touches[0].clientX,e.touches[0].clientY);},{passive:false});
    </script>
</body>
</html>

